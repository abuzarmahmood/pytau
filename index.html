<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="Simple python package to perform streamlined batch inference on changepoint models">
        
        
        <link rel="shortcut icon" href="img/favicon.ico">
        <title>PyTau</title>
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/fontawesome.min.css" rel="stylesheet">
        <link href="css/brands.min.css" rel="stylesheet">
        <link href="css/solid.min.css" rel="stylesheet">
        <link href="css/v4-font-face.min.css" rel="stylesheet">
        <link href="css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <link href="assets/_mkdocstrings.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body class="homepage">
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href=".">PyTau</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="." class="nav-link active" aria-current="page">Start</a>
                            </li>
                            <li class="nav-item">
                                <a href="api/" class="nav-link">API</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" class="nav-link disabled">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="api/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#pytau" class="nav-link">PyTau</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#models" class="nav-link">Models</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#installation" class="nav-link">Installation</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#usage" class="nav-link">Usage</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#workflows" class="nav-link">Workflows</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#data-organization" class="nav-link">Data Organization</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#pipeline" class="nav-link">Pipeline</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#parallelization" class="nav-link">Parallelization</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="pytau">PyTau</h1>
<p>This is a python package to perform streamlined, batched inference for changepoint models over parameter grids and datasets, and efficiently analyze sets of fitted models.</p>
<h2 id="models">Models</h2>
<p>PyTau uses changepoint models to detect shifts in data distributions. These models are designed to identify points in time where the statistical properties of a sequence of observations change. The package supports various types of changepoint models, including Gaussian and Poisson models. Each model is optimized for different types of data and use cases.</p>
<h3 id="available-models">Available Models</h3>
<h4 id="gaussian-changepoint-models">Gaussian Changepoint Models</h4>
<p>These models detect changes in both mean and variance or only in the mean for Gaussian data. They are suitable for continuous data where changes in statistical properties like mean and variance are of interest.</p>
<ul>
<li><code>gaussian_changepoint_mean_var_2d</code>: Detects changes in both mean and variance.</li>
<li><code>gaussian_changepoint_mean_dirichlet</code>: Uses a Dirichlet process prior to determine the number of states, detecting changes only in the mean.</li>
<li><code>gaussian_changepoint_mean_2d</code>: Detects changes only in the mean.</li>
</ul>
<h4 id="poisson-changepoint-models">Poisson Changepoint Models</h4>
<p>These models are used for spike train data, detecting changes in the rate of events. They are ideal for count data where the rate of occurrence is the primary focus.</p>
<ul>
<li><code>single_taste_poisson</code>: Models changepoints for single taste without hierarchical structure.</li>
<li><code>single_taste_poisson_dirichlet</code>: Uses a Dirichlet process prior for single taste spike train data.</li>
<li><code>single_taste_poisson_varsig</code>: Uses variable sigmoid slope inferred from data.</li>
<li><code>single_taste_poisson_varsig_fixed</code>: Uses sigmoid with given slope.</li>
<li><code>all_taste_poisson</code>: Fits changepoints across multiple tastes.</li>
<li><code>all_taste_poisson_varsig_fixed</code>: Fits changepoints across multiple tastes with fixed sigmoid slope.</li>
<li><code>single_taste_poisson_trial_switch</code>: Assumes only emissions change across trials.</li>
<li><code>all_taste_poisson_trial_switch</code>: Fits changepoints across multiple tastes with trial switching.</li>
</ul>
<h3 id="fitting-methods">Fitting Methods</h3>
<p>PyTau provides several fitting methods for these models:</p>
<ul>
<li><strong>ADVI (Automatic Differentiation Variational Inference)</strong>: A method for approximating the posterior distribution.</li>
<li><strong>MCMC (Markov Chain Monte Carlo)</strong>: A sampling method for drawing samples from the posterior distribution.</li>
<li><strong>DPP (Dirichlet Process Prior)</strong>: Used for models with a Dirichlet process prior to determine the number of states.</li>
</ul>
<h2 id="installation">Installation</h2>
<p>To set up PyTau, follow these steps:</p>
<pre><code class="language-bash"># Create and activate conda environment
conda create -n &quot;pytau_env&quot; python=3.6.13 ipython notebook -y
conda activate pytau_env

# Clone repository
cd ~/Desktop
git clone https://github.com/abuzarmahmood/pytau.git

# Install requirements from specified file
cd pytau
pip install -r requirements.txt

# Test everything is working by running notebook
cd pytau/how_to
bash scripts/download_test_data.sh
cd notebooks
jupyter notebook
# Run a notebook
</code></pre>
<h2 id="usage">Usage</h2>
<p>PyTau provides a streamlined workflow for fitting changepoint models to neural data. Here's a basic example of how to use the package:</p>
<pre><code class="language-python">import pytau
from pytau.changepoint_model import single_taste_poisson, advi_fit

# Load your spike data (trials x neurons x time)
spike_array = load_your_data()

# Create a model with desired number of states
model = single_taste_poisson(spike_array, states=3)

# Fit the model using ADVI
model, approx, lambda_stack, tau_samples, data = advi_fit(model, fit=10000, samples=1000)

# Analyze the results
# tau_samples contains the changepoint times
# lambda_stack contains the emission rates
</code></pre>
<p>For more detailed usage examples, refer to the notebooks in the <code>pytau/how_to/notebooks</code> directory.</p>
<h2 id="workflows">Workflows</h2>
<p>A typical workflow with PyTau involves the following steps:</p>
<ol>
<li><strong>Data Preparation</strong>: Organize your spike train data into the required format (typically trials x neurons x time).</li>
<li><strong>Model Selection</strong>: Choose the appropriate changepoint model based on your data characteristics (e.g., single_taste_poisson for single taste data).</li>
<li><strong>Inference</strong>: Run the model to detect changepoints using methods like ADVI or MCMC.</li>
<li><strong>Analysis</strong>: Analyze the results to understand the detected changepoints and their implications.</li>
</ol>
<p>PyTau also provides tools for batch processing and database management to streamline the analysis of large datasets:</p>
<ul>
<li><code>FitHandler</code>: Handles the pipeline of model fitting including loading data, preprocessing, fitting models, and saving results.</li>
<li><code>DatabaseHandler</code>: Manages transactions with the model database, allowing for efficient storage and retrieval of fitted models.</li>
</ul>
<h2 id="data-organization">Data Organization</h2>
<p>PyTau organizes fitted models in a central location, accessed by indexing an info file that contains model parameters and metadata. The metadata is also stored in the model file to enable recreation of the info file if needed.</p>
<p>The database for fitted models includes columns for:
- Model save path
- Animal Name
- Session date
- Taste Name
- Region Name
- Experiment name
- Fit Date
- Model parameters (Model Type, Data Type, States Num, Fit steps, Time lims, Bin Width)</p>
<p>Data stored in models includes:
- Model
- Approximation
- Lambda (emission rates)
- Tau (changepoint times)
- Data used to fit model
- Raw data (before preprocessing)
- Model and data details/parameters</p>
<h2 id="pipeline">Pipeline</h2>
<p>PyTau's pipeline consists of several components:</p>
<ol>
<li><strong>Model file</strong>: Generates models and performs inference (e.g., changepoint_model.py)</li>
<li><strong>Data pre-processing code</strong>: Handles different data types (shuffle, simulated, actual)</li>
<li><strong>I/O helper code</strong>: Loads data, processes it, and feeds it to modeling code</li>
<li><strong>Run script</strong>: Iterates over data for batch processing</li>
</ol>
<h2 id="parallelization">Parallelization</h2>
<p>Parallelization is currently performed using GNU Parallel by setting a separate Theano compiledir for each job. This prevents compilation clashes and allows for efficient batch processing of multiple models.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = ".",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="js/base.js"></script>
        <script src="search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>

<!--
MkDocs version : 1.6.1
Build Date UTC : 2025-03-31 12:59:38.990973+00:00
-->
